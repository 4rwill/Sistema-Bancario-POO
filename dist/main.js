import { Banco } from "./Banco.js";
import { PessoaFisica } from "./pessoaFisica.js";
import { PessoaJuridica } from "./pessoaJuridica.js";
import promptSync from "prompt-sync";
const prompt = promptSync();
// 1. Instancia o banco. O construtor J√Å VAI CHAMAR carregarDados()
const meuBanco = new Banco('db.json');
// 2. ---- Bloco de pr√©-cadastro REMOVIDO ----
// Os dados agora v√™m do db.json
// ---- Fim do pr√©-cadastro ----
let rodando = true;
while (rodando) {
    console.clear();
    console.log("===================================");
    console.log("üè¶ BEM-VINDO AO BANCO DIGITAL üè¶");
    console.log("===================================");
    console.log("1. Cadastrar Novo Cliente");
    console.log("2. Criar Conta para Cliente");
    console.log("3. Realizar Dep√≥sito");
    console.log("4. Realizar Saque");
    console.log("5. Listar todos os Clientes");
    console.log("6. Sair");
    console.log("===================================");
    const opcao = prompt('Escolha uma op√ß√£o: ');
    switch (opcao) {
        case '1':
            console.log("\n--- Cadastro de Novo Cliente ---");
            const tipoCliente = prompt("Digite 'PF' para Pessoa F√≠sica ou 'PJ' para Pessoa Jur√≠dica: ").toUpperCase();
            if (tipoCliente === 'PF') {
                const nome = prompt('Nome: ');
                const endereco = prompt('Endere√ßo: ');
                const cpf = prompt('CPF: ');
                const dataNasc = prompt('Data de Nascimento: ');
                const novoCliente = new PessoaFisica(nome, endereco, cpf, dataNasc);
                meuBanco.adicionarCliente(novoCliente); // J√° salva os dados
            }
            else if (tipoCliente === 'PJ') {
                const nomeFantasia = prompt('Nome Fantasia: ');
                const razaoSocial = prompt('Raz√£o Social: ');
                const endereco = prompt('Endere√ßo: ');
                const cnpj = prompt('CNPJ: ');
                const novoCliente = new PessoaJuridica(nomeFantasia, endereco, razaoSocial, cnpj);
                meuBanco.adicionarCliente(novoCliente); // J√° salva os dados
            }
            else {
                console.log("Op√ß√£o inv√°lida.");
            }
            break;
        case '2':
            console.log("\n--- Cria√ß√£o de Conta ---");
            const idCliente = prompt('Digite o CPF ou CNPJ do cliente: ');
            const numContaStr = prompt('Digite o n√∫mero da nova conta: ');
            const numConta = parseInt(numContaStr);
            meuBanco.criarConta(idCliente, numConta); // J√° salva os dados
            break;
        case '3':
            console.log("\n--- Realizar Dep√≥sito ---");
            const idDeposito = prompt('Digite o CPF/CNPJ do titular: ');
            const clienteDep = meuBanco.encontrarCliente(idDeposito);
            if (clienteDep) {
                // (Sua l√≥gica de pegar a primeira conta. Pode ser melhorada no futuro)
                const contaDep = clienteDep.getContas()[0];
                if (contaDep) {
                    const valorStr = prompt(`Valor do dep√≥sito para a conta ${contaDep.getNumero()}: R$`);
                    contaDep.depositar(parseFloat(valorStr));
                    // Saldo foi alterado, mas salvar√° no 'case 6'
                }
                else {
                    console.log("‚ùå Este cliente n√£o possui contas cadastradas.");
                }
            }
            else {
                console.log("‚ùå Cliente n√£o encontrado.");
            }
            break;
        case '4':
            console.log("\n--- Realizar Saque ---");
            const idSaque = prompt('Digite o CPF/CNPJ do titular: ');
            const clienteSaque = meuBanco.encontrarCliente(idSaque);
            if (clienteSaque) {
                const contaSaque = clienteSaque.getContas()[0];
                if (contaSaque) {
                    const valorStr = prompt(`Valor do saque para a conta ${contaSaque.getNumero()}: R$`);
                    contaSaque.sacar(parseFloat(valorStr));
                    // Saldo foi alterado, mas salvar√° no 'case 6'
                }
                else {
                    console.log("‚ùå Este cliente n√£o possui contas cadastradas.");
                }
            }
            else {
                console.log("‚ùå Cliente n√£o encontrado.");
            }
            break;
        case '5':
            console.clear();
            meuBanco.exibirClientes();
            break;
        case '6':
            // 3. Salva todos os dados antes de sair
            meuBanco.salvarDados();
            rodando = false;
            console.log("\nObrigado por usar nosso sistema. At√© logo! üëã");
            break;
        default:
            console.log('\n‚ùå Op√ß√£o inv√°lida! Tente novamente.');
            break;
    }
    if (rodando) {
        prompt('\nPressione ENTER para continuar...');
    }
}
